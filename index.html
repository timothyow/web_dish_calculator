
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, viewport-fit=cover"
  />
  <title>Negosyo Dish Costing Calculator — Minimal (3 Dishes)</title>
  <style>
    :root{
      --bg:#f8fafc;--panel:#fff;--muted:#64748b;--text:#0f172a;--border:#e2e8f0;
      --accent:#0f172a;--accentText:#fff;--radius:14px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
      background:var(--bg);color:var(--text)}
    header,footer{background:var(--panel);border-bottom:1px solid var(--border)}
    footer{border-top:1px solid var(--border);border-bottom:none}
    .container{max-width:1200px;margin:0 auto;padding:16px}
    h1{font-size:16px;margin:0}
    .sub{font-size:12px;color:var(--muted)}
    .grid{display:grid;gap:16px}
    @media (min-width: 768px){ .grid-md-2{grid-template-columns: repeat(2,minmax(0,1fr));} }
    @media (min-width: 1024px){ .grid-lg-3{grid-template-columns: repeat(3,minmax(0,1fr));} }

    .card{
      background:var(--panel);border:1px solid var(--border);border-radius:var(--radius);
      box-shadow:0 1px 2px rgba(0,0,0,.04);
    }
    .card-hd{padding:12px 16px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
    .card-bd{padding:16px}
    .label{font-size:12px;color:var(--muted);margin-bottom:6px}
    .input, .select{
      width:100%;padding:12px;border:1px solid var(--border);border-radius:12px;background:#fff;font-size:14px;color:var(--text);
    }
    .row{display:grid;gap:12px}
    .row-2{grid-template-columns:repeat(2,minmax(0,1fr))}
    .btn{
      display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:10px 12px;border-radius:12px;border:1px solid var(--border);
      background:#fff;color:var(--text);font-size:14px;cursor:pointer;
    }
    .btn-xs{padding:6px 8px;font-size:12px}
    .btn-solid{background:var(--accent);color:var(--accentText);border-color:var(--accent)}
    .muted{color:var(--muted);font-size:12px}
    .metrics{display:grid;gap:8px;grid-template-columns:repeat(2,minmax(0,1fr))}
    .metric{border:1px solid var(--border);background:#fff;border-radius:12px;padding:10px}
    .metric .k{font-size:11px;color:var(--muted)}
    .metric .v{font-size:16px;font-weight:700}
    .pill{
      display:inline-block;padding:4px 8px;font-size:11px;border-radius:999px;background:#fef3c7;color:#92400e;border:1px solid #fde68a
    }
    .total-bar{display:flex;align-items:center;justify-content:space-between}
    .switch{display:inline-flex;align-items:center;gap:8px;font-size:12px;color:var(--muted)}
    .switch input{width:16px;height:16px}
    .hr{height:1px;background:var(--border);margin:12px 0}
  </style>
</head>
<body>
  <header>
    <div class="container" style="display:flex;align-items:center;justify-content:space-between;">
      <h1>Negosyo Dish Costing Calculator</h1>
      <span class="sub">Clean • Minimal • No tracking</span>
    </div>
  </header>

  <main class="container">
    <div class="grid grid-md-2 grid-lg-3" id="columns">
      <!-- Column A -->
      <section class="card" data-col="0">
        <div class="card-hd">
          <div class="title">Dish A</div>
          <label class="switch">
            <input type="checkbox" class="include-toggle" checked>
            Include in total
          </label>
        </div>
        <div class="card-bd">
          <div class="row">
            <div>
              <label class="label">Dish</label>
              <select class="select dish-select"></select>
            </div>
            <div class="row row-2">
              <div>
                <label class="label">Mode</label>
                <div class="row row-2">
                  <button class="btn btn-xs mode-btn" data-mode="negosyo">Negosyo</button>
                  <button class="btn btn-xs mode-btn" data-mode="home">Home</button>
                </div>
              </div>
              <div>
                <label class="label">Season</label>
                <div class="row row-2">
                  <button class="btn btn-xs season-btn" data-season="year_round">Year-round</button>
                  <button class="btn btn-xs season-btn" data-season="seasonal">Seasonal</button>
                </div>
              </div>
            </div>
          </div>

          <div class="hr"></div>

          <div class="row row-2">
            <div>
              <label class="label">Total ingredients cost / batch (₱)</label>
              <input type="number" class="input field-ingredients" inputmode="decimal" value="0">
            </div>
            <div>
              <label class="label">Packaging / serving (₱)</label>
              <input type="number" class="input field-packaging" inputmode="decimal" value="5">
            </div>
            <div>
              <label class="label">Servings / batch</label>
              <input type="number" class="input field-servings" inputmode="decimal" value="10">
            </div>
            <div>
              <label class="label">Wastage %</label>
              <input type="number" class="input field-wastage" inputmode="decimal" value="5">
            </div>
            <div>
              <label class="label">Gas/Electric / batch (₱)</label>
              <input type="number" class="input field-utilities" inputmode="decimal" value="30">
            </div>
            <div>
              <label class="label">Labor / batch (₱)</label>
              <input type="number" class="input field-labor" inputmode="decimal" value="80">
            </div>
          </div>

          <div class="hr"></div>

          <div class="row row-2">
            <div>
              <label class="label">Selling price / serving (₱)</label>
              <input type="number" class="input field-price" inputmode="decimal" value="35">
            </div>
            <div>
              <label class="label">Target margin (0–0.95)</label>
              <input type="number" step="0.05" class="input field-target" inputmode="decimal" value="0.3">
              <div class="muted">0.30 = 30%</div>
            </div>
          </div>

          <div class="hr"></div>

          <div>
            <h3 class="label" style="font-size:12px;color:var(--text);font-weight:600">Results</h3>
            <div class="metrics">
              <div class="metric"><div class="k">Total batch cost</div><div class="v res-batch">₱0.00</div></div>
              <div class="metric"><div class="k">Servings (effective)</div><div class="v res-eff">0.0</div></div>
              <div class="metric"><div class="k">Cost / serving</div><div class="v res-cps">₱0.00</div></div>
              <div class="metric"><div class="k">Profit / serving</div><div class="v res-pps">₱0.00</div></div>
              <div class="metric"><div class="k">Margin %</div><div class="v res-margin">0.0%</div></div>
              <div class="metric"><div class="k">Profit / batch</div><div class="v res-ppb">₱0.00</div></div>
              <div class="metric"><div class="k res-break-lbl">Break-even @ 30%</div><div class="v res-break">₱0.00</div></div>
              <div class="metric"><div class="k">Ingredients share</div><div class="v res-ing-share">0.0%</div></div>
            </div>
            <div class="hr"></div>
            <div class="row">
              <div class="pill pill-low" style="display:none">Warning: Margin &lt; 20%</div>
              <div class="pill pill-ing" style="display:none">Ingredients &gt; 40% of cost</div>
              <div class="pill pill-pack" style="display:none">Packaging &gt; 10% of cost</div>
            </div>
          </div>
        </div>
      </section>

      <!-- Column B -->
      <section class="card" data-col="1">
        <div class="card-hd">
          <div class="title">Dish B</div>
          <label class="switch">
            <input type="checkbox" class="include-toggle">
            Include in total
          </label>
        </div>
        <div class="card-bd">
          <!-- Will be cloned from A for identical UI -->
        </div>
      </section>

      <!-- Column C -->
      <section class="card" data-col="2">
        <div class="card-hd">
          <div class="title">Dish C</div>
          <label class="switch">
            <input type="checkbox" class="include-toggle">
            Include in total
          </label>
        </div>
        <div class="card-bd">
          <!-- Will be cloned from A for identical UI -->
        </div>
      </section>
    </div>

    <!-- Totals -->
    <section class="card" style="margin-top:16px">
      <div class="card-hd">
        <h2 style="font-size:14px;margin:0">Totals</h2>
      </div>
      <div class="card-bd">
        <div class="total-bar">
          <div class="muted">Total profit (all included dishes)</div>
          <div class="v" id="total-profit" style="font-size:18px;font-weight:700">₱0.00</div>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="container" style="text-align:center;font-size:12px;color:var(--muted);">
      For planning only — verify actual costs and yields.
    </div>
  </footer>

  <script>
    /**********************
     * Simple Datasets
     **********************/
    const DISH_NAMES = [
      'Halo-halo',
      'Samalamig / Fruit Shake',
      'Leche Flan',
      'Spaghetti / Carbonara'
    ];

    const currency = (n)=>`₱${(Number.isFinite(n)?n:0).toFixed(2)}`;
    const safeNum = (v)=>{ const n = parseFloat(v); return Number.isFinite(n)&&n>=0 ? n : 0; };

    /**********************
     * State per column
     **********************/
    const initialRecipe = (dish='Halo-halo') => ({
      included: false,
      dishName: dish,
      // simplified: single input for total ingredients cost
      ingredientTotal: 0,        // PHP per batch
      packagingPerServing: 5,    // PHP per serving
      servingsPerBatch: 10,
      wastagePercent: 5,
      utilitiesPerBatch: 30,     // PHP per batch
      laborPerBatch: 80,         // PHP per batch
      sellingPrice: 35,          // PHP per serving
      targetMargin: 0.3,         // 0..0.95
      usageType: 'negosyo',
      seasonalFlag: 'year_round'
    });

    const state = [ initialRecipe('Halo-halo'), initialRecipe('Samalamig / Fruit Shake'), initialRecipe('Leche Flan') ];
    state[0].included = true;

    /**********************
     * DOM helpers
     **********************/
    function qs(sel, root=document){ return root.querySelector(sel) }
    function qsa(sel, root=document){ return Array.from(root.querySelectorAll(sel)) }

    /**********************
     * Calculations
     **********************/
    function calculateAll(s){
      const servings = safeNum(s.servingsPerBatch);
      const wastage = Math.min(100, safeNum(s.wastagePercent));
      const effectiveServings = servings * (1 - wastage/100);

      const packagingTotal = safeNum(s.packagingPerServing) * effectiveServings;
      const ingredientsTotal = safeNum(s.ingredientTotal);
      const utilities = safeNum(s.utilitiesPerBatch);
      const labor = safeNum(s.laborPerBatch);

      const totalBatchCost = ingredientsTotal + packagingTotal + utilities + labor;
      const costPerServing = effectiveServings > 0 ? totalBatchCost / effectiveServings : 0;
      const price = safeNum(s.sellingPrice);
      const profitPerServing = price - costPerServing;
      const marginPercent = price > 0 ? (profitPerServing / price) * 100 : 0;
      const profitPerBatch = profitPerServing * effectiveServings;

      const target = Math.max(0, Math.min(0.95, safeNum(s.targetMargin)));
      const breakEvenAtTargetMargin = (1 - target) > 0 ? costPerServing / (1 - target) : costPerServing;

      const ingredientShare = totalBatchCost > 0 ? ingredientsTotal / totalBatchCost : 0;
      const packagingShare = totalBatchCost > 0 ? packagingTotal / totalBatchCost : 0;

      return {
        effectiveServings,
        totalBatchCost,
        costPerServing,
        profitPerServing,
        marginPercent,
        profitPerBatch,
        breakEvenAtTargetMargin,
        ingredientShare,
        packagingShare,
        insights: {
          lowMargin: marginPercent < 20,
          ingredientShareHigh: ingredientShare > 0.4,
          packagingShareHigh: packagingShare > 0.1
        }
      };
    }

    function recalc(index){
      const section = qs(`[data-col="${index}"]`);
      const s = state[index];

      const calc = calculateAll(s);
      qs('.res-batch', section).textContent = currency(calc.totalBatchCost);
      qs('.res-eff', section).textContent = calc.effectiveServings.toFixed(1);
      qs('.res-cps', section).textContent = currency(calc.costPerServing);
      qs('.res-pps', section).textContent = currency(calc.profitPerServing);
      qs('.res-margin', section).textContent = `${calc.marginPercent.toFixed(1)}%`;
      qs('.res-ppb', section).textContent = currency(calc.profitPerBatch);
      qs('.res-break', section).textContent = currency(calc.breakEvenAtTargetMargin);
      qs('.res-break-lbl', section).textContent = `Break-even @ ${Math.round(s.targetMargin*100)}%`;
      qs('.res-ing-share', section).textContent = `${(calc.ingredientShare*100).toFixed(1)}%`;

      // insights
      qs('.pill-low', section).style.display  = calc.insights.lowMargin ? '' : 'none';
      qs('.pill-ing', section).style.display  = calc.insights.ingredientShareHigh ? '' : 'none';
      qs('.pill-pack', section).style.display = calc.insights.packagingShareHigh ? '' : 'none';
    }

    function recalcTotals(){
      let sum = 0;
      state.forEach((s)=>{ if (s.included) sum += calculateAll(s).profitPerBatch; });
      qs('#total-profit').textContent = currency(sum);
    }

    /**********************
     * Column init
     **********************/
    function initColumn(section, index){
      const s = state[index];
      const body = qs('.card-bd', section);

      // Clone inner from column 0 for identical structure
      if (index > 0) { body.innerHTML = qs('[data-col="0"] .card-bd').innerHTML; }

      // Fill dish choices
      const select = qs('.dish-select', section);
      select.innerHTML = DISH_NAMES.map(n=>`<option value="${n}">${n}</option>`).join('');
      select.value = s.dishName;
      select.addEventListener('change', ()=>{ s.dishName = select.value; });

      // Include toggle
      const include = qs('.include-toggle', section);
      include.checked = s.included;
      include.addEventListener('change', ()=>{ s.included = include.checked; recalc(index); recalcTotals(); });

      // Mode buttons
      qsa('.mode-btn', section).forEach(btn=>{
        const sync = ()=>qsa('.mode-btn', section).forEach(b=>{
          b.classList.toggle('btn-solid', b.dataset.mode === s.usageType);
        });
        btn.addEventListener('click', ()=>{ s.usageType = btn.dataset.mode; sync(); });
        sync();
      });

      // Season buttons
      qsa('.season-btn', section).forEach(btn=>{
        const sync = ()=>qsa('.season-btn', section).forEach(b=>{
          b.classList.toggle('btn-solid', b.dataset.season === s.seasonalFlag);
        });
        btn.addEventListener('click', ()=>{ s.seasonalFlag = btn.dataset.season; sync(); });
        sync();
      });

      // Fields
      const fIng  = qs('.field-ingredients', section);
      const fPack = qs('.field-packaging', section);
      const fServ = qs('.field-servings', section);
      const fWast = qs('.field-wastage', section);
      const fUtil = qs('.field-utilities', section);
      const fLab  = qs('.field-labor', section);
      const fPrice= qs('.field-price', section);
      const fTarg = qs('.field-target', section);

      fIng.value  = s.ingredientTotal;
      fPack.value = s.packagingPerServing;
      fServ.value = s.servingsPerBatch;
      fWast.value = s.wastagePercent;
      fUtil.value = s.utilitiesPerBatch;
      fLab.value  = s.laborPerBatch;
      fPrice.value= s.sellingPrice;
      fTarg.value = s.targetMargin;

      const onNum = (fn)=> (e)=>{ fn(safeNum(e.target.value)); recalc(index); recalcTotals(); };
      fIng.addEventListener('input', onNum(v=>s.ingredientTotal=v));
      fPack.addEventListener('input', onNum(v=>s.packagingPerServing=v));
      fServ.addEventListener('input', onNum(v=>s.servingsPerBatch=v));
      fWast.addEventListener('input', onNum(v=>s.wastagePercent=v));
      fUtil.addEventListener('input', onNum(v=>s.utilitiesPerBatch=v));
      fLab .addEventListener('input', onNum(v=>s.laborPerBatch=v));
      fPrice.addEventListener('input', onNum(v=>s.sellingPrice=v));
      fTarg.addEventListener('input', (e)=>{
        let v = safeNum(e.target.value);
        v = Math.max(0, Math.min(0.95, v));
        s.targetMargin = v;
        qs('.res-break-lbl', section).textContent = `Break-even @ ${Math.round(v*100)}%`;
        recalc(index); recalcTotals();
      });

      recalc(index);
    }

    function boot(){
      initColumn(qs('[data-col="0"]'), 0);
      initColumn(qs('[data-col="1"]'), 1);
      initColumn(qs('[data-col="2"]'), 2);
      recalcTotals();
    }
    document.addEventListener('DOMContentLoaded', boot);
  </script>
</body>
</html>
